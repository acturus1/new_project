<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ Lucky Slots Casino</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
        <header class="header">
            <h1><i class="fas fa-coins"></i> LUCKY SLOTS</h1>
            <div class="jackpot">
                <i class="fas fa-trophy"></i>
                <span>–î–ñ–ï–ö–ü–û–¢: <span id="jackpot-amount">{{ jackpot.amount }}</span> ‚ÇΩ</span>
            </div>
        </header>

        <!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
        <div class="game-container">
            <div class="slot-machine">
                <div class="reels-container">
                    <div class="reel" id="reel1">
                        <div class="symbol">üçí</div>
                    </div>
                    <div class="reel" id="reel2">
                        <div class="symbol">üçã</div>
                    </div>
                    <div class="reel" id="reel3">
                        <div class="symbol">üçä</div>
                    </div>
                </div>
                
                <div class="lever-container">
                    <button id="spin-btn" class="lever">
                        <i class="fas fa-hand-point-right"></i> –ö–†–£–¢–ò–¢–¨
                    </button>
                </div>
            </div>

            <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
            <div class="control-panel">
                <div class="balance-panel">
                    <h3><i class="fas fa-wallet"></i> –ë–ê–õ–ê–ù–°</h3>
                    <div class="balance-amount" id="balance">{{ user.balance if user else 1000 }}</div>
                </div>

                <div class="bet-control">
                    <h3><i class="fas fa-bet"></i> –°–¢–ê–í–ö–ê</h3>
                    <div class="bet-buttons">
                        <button class="bet-btn" data-bet="10">10</button>
                        <button class="bet-btn" data-bet="50">50</button>
                        <button class="bet-btn" data-bet="100">100</button>
                        <button class="bet-btn" data-bet="500">500</button>
                    </div>
                    <div class="custom-bet">
                        <input type="number" id="custom-bet" min="{{ settings.min_bet }}" 
                               max="{{ settings.max_bet }}" value="10">
                        <button id="set-bet">OK</button>
                    </div>
                    <div class="bet-info">
                        –ú–∏–Ω: {{ settings.min_bet }} | –ú–∞–∫—Å: {{ settings.max_bet }}
                    </div>
                </div>
            </div>

            <!-- –ò—Å—Ç–æ—Ä–∏—è –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="info-panel">
                <div class="win-history">
                    <h3><i class="fas fa-history"></i> –ü–û–°–õ–ï–î–ù–ò–ï –í–´–ò–ì–†–´–®–ò</h3>
                    <div id="win-history">
                        <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
                </div>
                
                <div class="rules">
                    <h3><i class="fas fa-info-circle"></i> –ü–†–ê–í–ò–õ–ê</h3>
                    <ul>
                        <li>3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–∞ = –≤—ã–∏–≥—Ä—ã—à √ó –º–Ω–æ–∂–∏—Ç–µ–ª—å</li>
                        <li>üçí √ó3 = √ó3 | üçã √ó3 = √ó4 | üçä √ó3 = √ó5</li>
                        <li>‚≠ê √ó3 = √ó20 + —à–∞–Ω—Å –Ω–∞ –î–ñ–ï–ö–ü–û–¢!</li>
                        <li>7Ô∏è‚É£ √ó3 + —É–¥–∞—á–∞ = –î–ñ–ï–ö–ü–û–¢!</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–∏–≥—Ä—ã—à–∞ -->
        <div id="win-modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2><i class="fas fa-trophy"></i> –ü–û–ó–î–†–ê–í–õ–Ø–ï–ú!</h2>
                <div class="win-amount" id="win-amount">0</div>
                <p>–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏!</p>
                <div class="win-symbols" id="win-symbols"></div>
                <button id="continue-btn">–ü–†–û–î–û–õ–ñ–ò–¢–¨</button>
            </div>
        </div>

        <!-- –ê–¥–º–∏–Ω —Å—Å—ã–ª–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞) -->
        {% if user and user.username == 'admin' %}
        <div class="admin-link">
            <a href="/admin" target="_blank"><i class="fas fa-cog"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å</a>
        </div>
        {% endif %}
    </div>

    <script src="{{ url_for('static', filename='js/game.js') }}"></script>
    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        let tg = window.Telegram.WebApp;
        tg.expand();
        
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Telegram
        const user = tg.initDataUnsafe.user;
        let userId = '{{ user.telegram_id if user else "guest" }}';
        let username = '{{ user.username if user else "Guest" }}';
        
        if (user) {
            userId = user.id.toString();
            username = user.username || user.first_name || 'Player';
        }
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ game.js
        window.userId = userId;
        window.username = username;
    </script>
</body>
</html>
